<!DOCTYPE html>

<html>
<head>
  <title>Content Cache Middleware</title>
  <link href="search/tipuesearch.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body class="page--readme">
<header>
  <div class="pager"><a href="content_cache.html" class="prev content_cache">&laquo;Content Cache</a><a href="index.html" class="index pager__book-title"></a><a href="index.html" class="next index">Index&raquo;</a></div></header>
<section class="sub-header">
  <div class="breadcrumbs"><a href="index.html">Index</a>
         &raquo
      </div>      <div class="search__wrapper">
  <form action="search--results.html">
    <input type="text" class="search-input" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>
  </section>


<h1>Content Cache Middleware</h1>

<section>

<h2>Summary</h2>

<p>This project provides a means of caching response bodies so that subsequent requests do not pass through the route callbacks.  It is helpful if the route callbacks involve expensive calculations to generate content.  It is built on the <a href="http://www.slimframework.com/docs/v3/features/caching.html">HTTP Caching middleware</a> and should be used instead of that middleware.  It ships with a file-based cache storage, but supports other types of caching via <code>\AKlump\Slim\Middleware\ContentCacheInterface</code>.</p>

<h2>Quick Start</h2>

<pre><code>$container = $app-&gt;getContainer();
$container['cache'] = function () {
  return new \Slim\HttpCache\CacheProvider();
};
$container['content_cache'] = function () {
  return new \AKlump\Slim\Middleware\FileCache('/path/to/cache/dir');
};

// Register this middleware.
$app-&gt;add(new \AKlump\Slim\Middleware\ContentCache($container['cache'], $container['content_cache'], 3600));
</code></pre>

<h2>Contributing</h2>

<p>If you find this project useful... please consider <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=4E5KZHDQCEUV8&amp;item_name=Gratitude%20for%20aklump%2Faklump_slim">making a donation</a>.</p>

<h2>Installation</h2>

<ol>
<li><p>This middleware replaces <a href="http://www.slimframework.com/docs/v3/features/caching.html">HTTP Caching</a> therefore you should not add that middleware as shown in those instructions.  <strong>Do not do the following:</strong></p>

<pre><code>$app-&gt;add(new \Slim\HttpCache\Cache('public', 86400));
</code></pre></li>
<li><p>However, you will need to register the service provider from that middleware as shown in the <em>Quick Start</em> above.</p></li>
</ol>

<h2>Advanced Usage</h2>

<h3>How do I alter the body prior to caching?</h3>

<p>If you want to alter the response body content before it is written to cache use the fourth argument callback as shown below, which adds a last modified note</p>

<pre><code>$app-&gt;add(new \AKlump\Slim\Middleware\ContentCache(
  $container['cache'],
  $container['content_cache'],
  3600,
  function (\DateTime $modified, $html_body) use ($settings) {
    return $html_body . sprintf("Last modified: %s', $modified-&gt;format('r'));
  }
));
</code></pre>

<h3>How do I use a database for caching content?</h3>

<p>You may write your own class that implements <code>\AKlump\Slim\Middleware\ContentCacheInterface</code>.</p>
</section>

<div class="search__results">
  <div id="tipue_search_content"></div>
</div>

<footer>
  <div class="pager"><a href="content_cache.html" class="prev content_cache">&laquo;Content Cache</a><a href="index.html" class="index pager__book-title"></a><a href="index.html" class="next index">Index&raquo;</a></div>  
  <div id="footer-legaleeze">
    <p class="legaleeze center">Version: 0.1.0 &bull; Last Updated: Mon, 13 May 2019 18:53:47 -0700</p>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="search/tipuesearch_content.js"></script>
  <script src="search/tipuesearch_set.js"></script>
  <script src="search/tipuesearch.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#tipue_search_input').tipuesearch()
    })
  </script>
<script src="js/core.js"></script>
</body>
</html>

